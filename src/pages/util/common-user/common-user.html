<!--
  Generated template for the CommonUserPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  <ion-navbar>
    <ion-buttons start>
      <button ion-button icon-only (click)="close()">
        <ion-icon name="arrow-back" style="color: #fff"></ion-icon>
      </button>
    </ion-buttons>
    <ion-title>人员</ion-title>
  </ion-navbar>
  <ion-toolbar no-border-top class="page-search">
    <ion-searchbar
      (ionInput)="searchUser($event)"
      placeholder="登陆用户名或真实姓名"
    ></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher (ionRefresh)="doRefresh($event)">
    <ion-refresher-content
      pullingIcon="arrow-dropdown"
      pullingText="下拉刷新"
      refreshingSpinner="circles"
      refreshingText="正在刷新..."
    ></ion-refresher-content>
  </ion-refresher>
  <ion-list insert>
    <ion-item *ngFor="let user of userList" no-lines (click)="selectUser(user)">
      <ion-avatar item-start>
        <img src="assets/imgs/avatar/{{user.icon||'00.png'}}" />
      </ion-avatar>
      <ion-label>
        <h2>{{user.realName}}</h2>
        <p><span>{{user.userName}}</span>|<span>{{user.deptName}}</span></p>
      </ion-label>
      <div item-content class="checked-icon" *ngIf="showIcon(user.userId)">
        <!-- <img src="assets/imgs/buttons/ok.png" /> -->
        <ion-icon name="ok"></ion-icon>
      </div>
    </ion-item>
  </ion-list>
  <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content
      *ngIf="closeInfinite"
      loadingSpinner="crescent"
      loadingText="加载更多数据..."
    ></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>

<ion-footer>
  <ion-toolbar no-border-top *ngIf="isSingle">
    <button ion-button block class="clear" color="light" (click)="clear()">
      清除
    </button>
  </ion-toolbar>
  <ion-toolbar class="footer-bar" *ngIf="!isSingle">
    <ion-grid>
      <ion-row>
        <ion-col col-6>
          <button
            ion-button
            icon-end
            small
            outline
            class="clear-btn"
            color="light"
            (click)="toggleSelectedItemModal()"
          >
            已选（<span *ngIf="hiddenSelectedModal"
              >{{selectedItem.length}}</span
            >
            <span *ngIf="!hiddenSelectedModal" id="count"
              >{{selectedItem.length}}</span
            >
            ）
            <ion-icon
              name="{{hiddenSelectedModal?'arrow-up':'arrow-down'}}"
            ></ion-icon>
          </button>
        </ion-col>
        <ion-col col-6>
          <button ion-button small class="ok-btn" (click)="commitUser()">
            确定
          </button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-toolbar>
</ion-footer>
